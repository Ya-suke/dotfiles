#!/bin/sh

echo "  ïª¨ Testing Connection.... "
echo "  ðŸ“¡ "
ping -c 1 -W 2 google.com > /dev/null 2>&1 && echo "  ðŸ—±  connected " || (echo "  ðŸ—¶  disconnected " && echo "" && exit 4 )

status=$?

if test $status -eq 4
then 
    echo "  â˜   Exiting..."
    exit
else
    continue
fi

echo ""
echo ""
echo "îœ‚ Pushing tasks to repo ï†—  ï†—  îœ‚.."

echo ""

git -C /home/yasuke/.task/ push -u origin main


echo ""
echo "îœ‚ Pushing dotfiles to repo ï†—  ï†—  îœ‚.."

/usr/bin/git --git-dir=/home/yasuke/dotfiles/ --work-tree=/home/yasuke commit -a -m "update dotfiles"

echo ""

echo " Fetching origin to then push"

/usr/bin/git --git-dir=/home/yasuke/dotfiles/ --work-tree=/home/yasuke fetch origin

/usr/bin/git --git-dir=/home/yasuke/dotfiles/ --work-tree=/home/yasuke push origin main
# chezmoi apply

echo ""

echo " backing up group and hist files"
sudo cat /etc/group > ~/group.bak && echo " group backup successful" || echo " ðŸ—¶  group backup failed"
cat ~/.zsh_history > ~/.zsh_history.bak && echo " hist backup successful" || echo " ðŸ—¶  hist backup failed"

echo " âœ…âœ…âœ…"

echo "Exiting..."
